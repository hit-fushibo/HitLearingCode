# 系统调用

## 实验结果

- 编译运行 testlab2.c，结果如下：

  ![1701009270790](images/1701009270790.png)
- 编译运行 testlab2.sh，结果如下：

  ![1701010254804](images/1701010254804.png)

## 问题回答

1. 从 Linux 0.11 现在的机制看，它的系统调用最多能传递几个参数？

   Linux0.11 的系统调用最多能传递 3 个参数，这是由于在 include/unistd.h 中的\_syscall3 宏所决定的。
   ![1701009397992](images/1701009397992.png)
2. 你能想出办法来扩大这个限制吗？

   要扩大这个限制，可以考虑将参数存放在栈中，然后通过寄存器 ebx、ecx、edx 传递参数的地址，或者增加额外的寄存器来传递更多参数。
3. 用文字简要描述向 Linux 0.11 添加一个系统调用 foo() 的步骤。

   1. 在 include/unistd.h 中，添加一个名为 foo()的系统调用编号
   2. 在 include/linux/sys.h 中添加 foo()的声明，并将其加入系统调用列表中
   3. 在 kernal/system_call.s 修改系统调用的总数
   4. 在 kernal 中添加 foo()的原型 foo.c，并修改 Makefile 使得内核能够被正确编译
   5. 编译内核
   6. 在用户空间中编写应用程序，并使用 system_call()函数调用 foo()
